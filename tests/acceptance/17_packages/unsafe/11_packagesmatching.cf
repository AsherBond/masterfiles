#######################################################
#
# Test packagesmatching()
#
# This is not a real test, but a preparation policy for
# 12_packagesmatching.cf. See the comments in there.
#
#######################################################

body common control
{
      inputs => { "./packages-info.cf.sub", "../../default.cf.sub", "../../../../lib/3.6/packages.cf" };
      bundlesequence  => { default("$(this.promise_filename)") };
      version => "1.0";
}

#######################################################

bundle agent init
{
}

#######################################################

bundle agent test
{
  vars:
      "package_name" string => "$(p.name[1])";
      "package_version" string => "$(p.version[1])";

  packages:
    debian::
      "$(package_name)"
        package_policy => "add",
        package_method => apt_get;

    redhat::
      "$(package_name)"
        package_policy => "add",
        package_method => yum_rpm;
}

#######################################################

bundle agent check
{
  reports:
      # Not a real test case so pass unconditionally.
      "$(this.promise_filename) Pass";
}
